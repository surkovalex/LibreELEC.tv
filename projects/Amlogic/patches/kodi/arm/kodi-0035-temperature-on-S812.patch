From f8e19a87dd6b9cc85e5fdc514fc35d7b0cd4a81d Mon Sep 17 00:00:00 2001
From: alex <surkov.alex@gmail.com>
Date: Sun, 28 May 2017 14:09:05 +0300
Subject: [PATCH] temperature on S812

---
 xbmc/utils/CPUInfo.cpp | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

diff --git a/xbmc/utils/CPUInfo.cpp b/xbmc/utils/CPUInfo.cpp
index aa4531c..b3192ab 100644
--- a/xbmc/utils/CPUInfo.cpp
+++ b/xbmc/utils/CPUInfo.cpp
@@ -265,7 +265,15 @@ CCPUInfo::CCPUInfo(void)
   }
 #else
   m_fProcStat = fopen("/proc/stat", "r");
-  m_fProcTemperature = fopen("/proc/acpi/thermal_zone/THM0/temperature", "r");
+  m_fProcTemperature = fopen("/sys/devices/virtual/thermal/thermal_zone1/temp", "r");
+  if (m_fProcTemperature == NULL)
+    m_fProcTemperature = fopen("/sys/devices/virtual/thermal/thermal_zone0/temp", "r");
+  if (m_fProcTemperature == NULL)
+    m_fProcTemperature = fopen("/sys/class/hwmon/hwmon1/temp1_input", "r");
+  if (m_fProcTemperature == NULL)
+    m_fProcTemperature = fopen("/sys/class/hwmon/hwmon0/temp1_input", "r");
+  if (m_fProcTemperature == NULL)
+    m_fProcTemperature = fopen("/proc/acpi/thermal_zone/THM0/temperature", "r");
   if (m_fProcTemperature == NULL)
     m_fProcTemperature = fopen("/proc/acpi/thermal_zone/THRM/temperature", "r");
   if (m_fProcTemperature == NULL)
@@ -642,7 +650,6 @@ bool CCPUInfo::getTemperature(CTemperature& temperature)
     if (!ret)
     {
       ret = fscanf(m_fProcTemperature, "%d", &value);
-      value = value / 1000;
       scale = 'c';
       ret++;
     }
-- 
1.9.1

